FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"IyMgU2hhcmVkIHBhcmFtZXRlcnMKX2JpbmRfcGFyYW1zOiAmX2JpbmRfcGFyYW1zCiMgUHJvdmlz\
aW9uIGJpbmQgcGFyYW1zCiAgLSBuYW1lOiBzZXJ2aWNlX25hbWUKICAgIGRpc3BsYXlfZ3JvdXA6\
IFByb3Zpc2lvbgogICAgcmVxdWlyZWQ6IFRydWUKICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBzZXJ2\
aWNlIHRvIGJpbmQKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogcmVkaXJlY3RfdXJpcwogICAg\
ZGlzcGxheV9ncm91cDogUHJvdmlzaW9uCiAgICByZXF1aXJlZDogVHJ1ZQogICAgdGl0bGU6IFJl\
ZGlyZWN0IFVSSXMKICAgIGRlc2NyaXB0aW9uOiBWYWxpZCBSZWRpcmVjdCBVUklzIGEgYnJvd3Nl\
ciBjYW4gcmVkaXJlY3QgdG8gYWZ0ZXIgYSBzdWNjZXNzZnVsIGxvZ2luL2xvZ291dC4gU2ltcGxl\
IHdpbGRjYXJkcyBhcmUgYWxsb3dlZC4gZS5nLiBodHRwczovL215c2VydmljZS1teXByb2plY3Qu\
YXBwcy5leGFtcGxlLmNvbS8qCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IHdlYl9vcmlnaW5z\
CiAgICBkaXNwbGF5X2dyb3VwOiBQcm92aXNpb24KICAgIHRpdGxlOiBXZWIgT3JpZ2lucwogICAg\
ZGVzY3JpcHRpb246IFdlYiBPcmlnaW5zIHRvIGFsbG93IENPUlMKICAgIHR5cGU6IHN0cmluZwog\
ICMgQmluZCBzZWNyZXQgcGFyYW1zICh3aGljaCBlbnYgdmFyaWFibGVzIHRvIGNyZWF0ZSkKICAt\
IG5hbWU6IHNzb191cmxfbmFtZQogICAgZGVmYXVsdDogU1NPX1VSTAogICAgZGlzcGxheV9ncm91\
cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2FrIFVSTCBWYXJpYWJsZSBuYW1lCiAgICBkZXNj\
cmlwdGlvbjogSG93IHRoZSBhcHBsaWNhdGlvbiB3aWxsIHJlZmVyIHRvIHRoZSBLZXljbG9hayBV\
UkwKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogc3NvX3JlYWxtX25hbWUKICAgIGRlZmF1bHQ6\
IFNTT19SRUFMTQogICAgZGlzcGxheV9ncm91cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2Fr\
IFJlYWxtIFZhcmlhYmxlIG5hbWUKICAgIGRlc2NyaXB0aW9uOiBIb3cgdGhlIGFwcGxpY2F0aW9u\
IHdpbGwgcmVmZXIgdG8gdGhlIEtleWNsb2FrIFJlYWxtCiAgICB0eXBlOiBzdHJpbmcKICAtIG5h\
bWU6IHNzb19jbGllbnRfbmFtZQogICAgZGVmYXVsdDogU1NPX0NMSUVOVAogICAgZGlzcGxheV9n\
cm91cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2FrIENsaWVudCBWYXJpYWJsZSBuYW1lCiAg\
ICBkZXNjcmlwdGlvbjogSG93IHRoZSBhcHBsaWNhdGlvbiB3aWxsIHJlZmVyIHRvIHRoZSBLZXlj\
bG9hayBDbGllbnQgbmFtZQogICAgdHlwZTogc3RyaW5nCnZlcnNpb246IDEuMC4wCm5hbWU6IGtl\
eWNsb2FrLWFwYgpkZXNjcmlwdGlvbjogS2V5Y2xvYWsgLSBPcGVuIFNvdXJjZSBJZGVudGl0eSBh\
bmQgQWNjZXNzIE1hbmFnZW1lbnQKYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6\
CiAgLSBzc28KICAtIGtleWNsb2FrCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBLZXljbG9hayAo\
QVBCKQogIGltYWdlVXJsOiAiaHR0cHM6Ly9naXRodWIuY29tL2Fuc2libGVwbGF5Ym9va2J1bmRs\
ZS9rZXljbG9hay1hcGIvcmF3L21hc3Rlci9kb2NzL2ltZ3Mva2V5Y2xvYWtfaWNvLnBuZyIKICBk\
b2N1bWVudGF0aW9uVXJsOiAiaHR0cDovL3d3dy5rZXljbG9hay5vcmcvZG9jdW1lbnRhdGlvbi5o\
dG1sIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIGRlcGVuZGVuY2ll\
czoKICAgIC0gJ2RvY2tlci5pby9qYm9zcy9rZXljbG9hay1vcGVuc2hpZnQ6My40LjMuRmluYWwn\
CiAgICAtICdjZW50b3MvcG9zdGdyZXNxbC05NS1jZW50b3M3OjkuNScKICBzZXJ2aWNlTmFtZTog\
a2V5Y2xvYWsKcGxhbnM6CiAgLSBuYW1lOiBlcGhlbWVyYWwKICAgIGRlc2NyaXB0aW9uOiBEZXBs\
b3kga2V5Y2xvYWsgd2l0aG91dCBwZXJzaXN0ZW5jZQogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIGRpc3BsYXlOYW1lOiBLZXljbG9hayBlcGhlbWVyYWwKICAgIHBhcmFtZXRlcnM6\
CiAgICAgIC0gbmFtZTogYWRtaW5fdXNlcm5hbWUKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEtl\
eWNsb2FrIGFkbWluIHVzZXJuYW1lCiAgICAgIC0gbmFtZTogYWRtaW5fcGFzc3dvcmQKICAgICAg\
ICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRpc3BsYXlfdHlw\
ZTogcGFzc3dvcmQKICAgICAgICB0aXRsZTogS2V5Y2xvYWsgYWRtaW4gcGFzc3dvcmQKICAgICAg\
LSBuYW1lOiBhcGJfa2V5Y2xvYWtfdXJpCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEtleWNsb2FrIFVSTAogICAgICAgIGRlc2NyaXB0\
aW9uOiBVUkwgd2hlcmUgdGhlIGFwcGxpY2F0aW9ucyBzaG91bGQgcmVkaXJlY3QgdG8gZm9yIGF1\
dGhlbnRpY2F0aW9uLiBNdXN0IGJlIHJlc29sdmFibGUgYnkgdGhlIGJyb3dzZXIgYW5kIHBvZHMu\
IExlYXZlIGVtcHR5IHRvIHVzZSB0aGUgaG9zdCBnZW5lcmF0ZWQgYnkgdGhlIHJvdXRlCiAgICAg\
IC0gbmFtZToga2V5Y2xvYWtfdXNlcnMKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgdGl0bGU6\
IFVzZXJzCiAgICAgICAgZGVzY3JpcHRpb246IEpTT04gZGVmaW5pbmcgdGhlIHVzZXJzIHRvIGFk\
ZCB0byB0aGUgcmVhbG0gYW5kIHRoZWlyIG1lbWJlcnNoaXBzCiAgICAgIC0gbmFtZToga2V5Y2xv\
YWtfcm9sZXMKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgdGl0bGU6IFJvbGVzCiAgICAgICAg\
ZGVzY3JpcHRpb246IEpTT04gZGVmaW5pbmcgdGhlIHJvbGVzIHRvIGFkZCB0byB0aGUgcmVhbG0K\
ICAgIGJpbmRfcGFyYW1ldGVyczogKl9iaW5kX3BhcmFtcwoKICAtIG5hbWU6IHBlcnNpc3RlbnQK\
ICAgIGRlc2NyaXB0aW9uOiBEZXBsb3kga2V5Y2xvYWsgd2l0aCBwZXJzaXN0ZW5jZQogICAgZnJl\
ZTogVHJ1ZQogICAgZGVmYXVsdDogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1l\
OiBLZXljbG9hayBwZXJzaXN0ZW50CiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGFkbWlu\
X3VzZXJuYW1lCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkZWZhdWx0OiBhZG1pbgog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBLZXljbG9hayBhZG1pbiB1c2VybmFt\
ZQogICAgICAtIG5hbWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAg\
dGl0bGU6IEtleWNsb2FrIGFkbWluIHBhc3N3b3JkCiAgICAgIC0gbmFtZTogYXBiX2tleWNsb2Fr\
X3VyaQogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBLZXljbG9hayBVUkwKICAgICAgICBkZXNjcmlwdGlvbjogVVJMIHdoZXJlIHRoZSBh\
cHBsaWNhdGlvbnMgc2hvdWxkIHJlZGlyZWN0IHRvIGZvciBhdXRoZW50aWNhdGlvbi4gTXVzdCBi\
ZSByZXNvbHZhYmxlIGJ5IHRoZSBicm93c2VyIGFuZCBwb2RzLiBMZWF2ZSBlbXB0eSB0byB1c2Ug\
dGhlIGhvc3QgZ2VuZXJhdGVkIGJ5IHRoZSByb3V0ZQogICAgICAtIG5hbWU6IHB2Y19zaXplCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogMjAwTWkKICAgICAgICBkZXNjcmlw\
dGlvbjogRGF0YWJhc2Ugc3RvcmFnZSBzaXplCiAgICAgICAgdGl0bGU6IFN0b3JhZ2Ugc2l6ZQog\
ICAgICAtIG5hbWU6IGtleWNsb2FrX3VzZXJzCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICAgIHRp\
dGxlOiBVc2VycwogICAgICAgIGRlc2NyaXB0aW9uOiBKU09OIGRlZmluaW5nIHRoZSB1c2VycyB0\
byBhZGQgdG8gdGhlIHJlYWxtIGFuZCB0aGVpciBtZW1iZXJzaGlwcwogICAgICAtIG5hbWU6IGtl\
eWNsb2FrX3JvbGVzCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICAgIHRpdGxlOiBSb2xlcwogICAg\
ICAgIGRlc2NyaXB0aW9uOiBKU09OIGRlZmluaW5nIHRoZSByb2xlcyB0byBhZGQgdG8gdGhlIHJl\
YWxtCiAgICBiaW5kX3BhcmFtZXRlcnM6ICpfYmluZF9wYXJhbXMKCiAgLSBuYW1lOiBleHRlcm5h\
bAogICAgZGVzY3JpcHRpb246IEFsbG93cyBhdXRoZW50aWNhdGluZyBhcHBsaWNhdGlvbnMgdG8g\
YW4gZXh0ZXJuYWwgS2V5Y2xvYWsgaW5zdGFuY2UKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRh\
OgogICAgICBkaXNwbGF5TmFtZTogS2V5Y2xvYWsgKGV4dGVybmFsKQogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBhZG1pbl91c2VybmFtZQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
ICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogS2V5\
Y2xvYWsgYWRtaW4gdXNlcm5hbWUKICAgICAgLSBuYW1lOiBhZG1pbl9wYXNzd29yZAogICAgICAg\
IHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBl\
OiBwYXNzd29yZAogICAgICAgIHRpdGxlOiBLZXljbG9hayBhZG1pbiBwYXNzd29yZAogICAgICAt\
IG5hbWU6IGFwYl9rZXljbG9ha191cmkKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHR5\
cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBLZXljbG9hayBVUkwKICAgICAgICBkZXNjcmlwdGlv\
bjogVVJMIHdoZXJlIHRoZSBhcHBsaWNhdGlvbnMgc2hvdWxkIHJlZGlyZWN0IHRvIGZvciBhdXRo\
ZW50aWNhdGlvbi4gTXVzdCBiZSByZXNvbHZhYmxlIGJ5IHRoZSBicm93c2VyIGFuZCBwb2RzLgog\
ICAgICAtIG5hbWU6IGtleWNsb2FrX3VzZXJzCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICAgIHRp\
dGxlOiBVc2VycwogICAgICAgIGRlc2NyaXB0aW9uOiBKU09OIGRlZmluaW5nIHRoZSB1c2VycyB0\
byBhZGQgdG8gdGhlIHJlYWxtIGFuZCB0aGVpciBtZW1iZXJzaGlwcwogICAgICAtIG5hbWU6IGtl\
eWNsb2FrX3JvbGVzCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICAgIHRpdGxlOiBSb2xlcwogICAg\
ICAgIGRlc2NyaXB0aW9uOiBKU09OIGRlZmluaW5nIHRoZSByb2xlcyB0byBhZGQgdG8gdGhlIHJl\
YWxtCiAgICBiaW5kX3BhcmFtZXRlcnM6ICpfYmluZF9wYXJhbXMK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles

RUN chmod -R g=u /opt/{ansible,apb}
USER apb
